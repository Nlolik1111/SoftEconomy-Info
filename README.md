# Справка по Telegram-боту экономики (полная)

> Этот документ - **полная пользовательская справка** со всеми тонкостями системы. В нём описаны команды, правила, лимиты, подписки, банк, казино, рынки, роли и дополнительные параметры.

## Оглавление

- [1. Что делает бот](#1-что-делает-бот)
- [2. Быстрый старт](#2-быстрый-старт)
- [3. Подписки и доступ](#3-подписки-и-доступ)
- [4. Базовый банк и кошелёк](#4-базовый-банк-и-кошелёк)
- [5. Команды и сценарии](#5-команды-и-сценарии)
- [6. Банк: депозиты, выводы, кредиты](#6-банк-депозиты-выводы-кредиты)
- [7. Казино: правила и лимиты](#7-казино-правила-и-лимиты)
- [8. Рынки и курсы (предпросмотр без подписки)](#8-рынки-и-курсы-предпросмотр-без-подписки)
- [9. Магазин и покупки](#9-магазин-и-покупки)
- [10. Работы и рейтинг активности](#10-работы-и-рейтинг-активности)
- [11. Тёмный рынок](#11-тёмный-рынок)
- [11.1. Квесты тёмного рынка](#111-квесты-тёмного-рынка)
- [11.2. Рекламные предложения (чёрный рынок)](#112-рекламные-предложения-чёрный-рынок)
- [11.3. Как купить товар чёрного рынка](#113-как-купить-товар-чёрного-рынка)
- [12. Роли, права, совладельцы и настройки](#12-роли-права-совладельцы-и-настройки)
- [12.1. Роли и права](#121-роли-и-права)
- [12.2. Совладельцы группы](#122-совладельцы-группы)
- [12.3. Реферальная система](#123-реферальная-система)
- [13. Дополнительные параметры роли (settings.json)](#13-дополнительные-параметры-роли-settingsjson)
- [14. Список параметров роли (≈100 параметров)](#14-список-параметров-роли-100-параметров)
- [15. Безопасность и анти-фарм](#15-безопасность-и-анти-фарм)
- [16. Частые вопросы](#16-частые-вопросы)

---

## 1. Что делает бот

Бот добавляет в чат **полноценную экономику**:

- единая валюта с курсом, ежедневными бонусами и налогами;
- банк с депозитами, выводом, рейтингом и кредитами;
- казино с лимитами и вероятностями;
- рынок «долей доверия» (акции) с графиками и событиями;
- магазин товаров/услуг (фиксированный или редактируемый);
- тёмный рынок с квестами;
- расширенная система ролей, прав и параметров.

---

## 2. Быстрый старт

1. Добавьте бота в группу и выполните `/settings` в личке.
2. Установите владельца группы (бот создаст владельца автоматически при первом входе).
3. Настройте валюту, префиксы и параметры группы.
4. Откройте экономику командой `!!баланс`.
5. Проверьте доступ к банку: `!!банк` (от плана Медиум).

---

## 3. Подписки и доступ

**Планы:**

- **BASIC** - минимальные лимиты, нет торговли на рынке, доступен предпросмотр.
- **MEDIUM** - доступ к банку и базовой торговле.
- **ULTIMATE** - все функции без ограничений, включая скрипты и расширенные механики.

Проверка и покупка: `/plans`.

**Важно:** Даже без подписки пользователь может **видеть рынки и курсы**, но **не может торговать**.

---

## 4. Базовый банк и кошелёк

### Базовый банк

- При первом входе у каждого пользователя автоматически создаётся банковский счёт.
- У банковского счёта есть **баланс** и **история операций**.
- Банк не даёт пассивного дохода - это **инфраструктура** для экономики.
- **Кредитов без подписки нет** (доступ зависит от плана/прав).

### Кошелёк

- Все игровые доходы и расходы фиксируются.
- Переводы другим игрокам имеют дневной лимит и комиссию.
- Есть задержка на крупные переводы для борьбы с мультиаккаунтами.

---

## 5. Команды и сценарии

**Основные:**

- `!!баланс [@user]` - баланс пользователя.
- `!!профиль [@user]` - профиль и рейтинг.
- `!!топ баланс|рейтинг` - таблица лидеров.
- `!!курс` - курс валюты в чате.
- `!!инфо` - сводка параметров.

**Админские:**

- `!!баланс зачислить @user amount` - начислить средства **из воздуха**.
- `!!баланс изъять @user amount/all` - изъять средства.
- `!!баланс установить @user amount` - установить точный баланс.

---

## 6. Банк: депозиты, выводы, кредиты

**Команды:**

- `!!банк` - меню банковских операций.
- `!!банк депозит сумма [дни]` - депозит с заморозкой 7–30 дней.
- `!!банк вывод сумма/all` - вывести из банка.
- `!!банк перевод @user сумма` - банковский перевод.
- `!!банк кредит сумма срок` - кредит (если доступен).
- `!!банк снять [@user] сумма/all` - снять из банка (админ/модератор).

**Админские корректировки:**

- `!!банк зачислить @user сумма` - **зачисляет в банк из воздуха**.
- `!!банк изъять @user сумма/all` - **изымает из банка**.
- `!!банк установить @user сумма` - задать точный баланс банка.

### Важные детали

- **Комиссии** зависят от рейтинга.
- **Заморозка** защищает депозит и повышает ставку.
- **Банкротство** временно блокирует операции.
- **Кредиты** имеют график платежей и штрафы за просрочку.

---

## 7. Казино: правила и лимиты

- В казино доступны рулетка, слоты, монетка, кости и покер.
- Есть лимиты по количеству игр за период.
- Шанс выигрыша, ставки и выплаты могут быть изменены **через параметры ролей**.

**Примеры команд:**

- `!!казино рулетка красный 500`
- `!!казино слоты 200`
- `!!казино монетка орел 100`
- `!!казино покер 5 1000`

---

## 8. Рынки и курсы (предпросмотр без подписки)

**Без подписки:**

- Пользователь видит **курсы валют, акций и ресурсов**.
- Доступны **изменения во времени**, простые графики.
- Показываются **последние события** и «новости рынка».
- Интерфейс отображает **упущенные возможности** (пример потенциальной прибыли).

**Что запрещено без подписки:**

- торговля (покупка/продажа),
- ордера,
- арбитраж.

Это сделано как **предпросмотр**: игрок видит рынок, но не может торговать, что стимулирует получить доступ.

---

## 9. Магазин и покупки

**Режимы магазина:**

- **Фиксированный** - товары задаются системой.
- **Обычный** - пользователи могут создавать товары.

**Команды:**

- `!!магазин` - открыть витрину.
- `!!покупки [@user]` - история покупок.
- `!!товар добавить "Название" цена [кол-во]` - создать товар.

**Особенности:**

- Есть налог магазина.
- Возможны ограниченные остатки.
- Покупки можно использовать.

---

## 10. Работы и рейтинг активности

- У каждого пользователя есть рейтинг активности.
- Работа приносит доход, но зависит от рейтинга и кулдауна.
- Есть штрафы за увольнение.

**Команды:**

- `!!работа` - получить/сменить работу.
- `!!работа инфо [@user]` - карточка работы.

---

## 11. Тёмный рынок

Тёмный рынок — это **две разные механики**, обе запускаются для каждой группы отдельно.

### 11.1. Квесты тёмного рынка

- Раз в сутки бот **готовит квест** для случайного участника группы.
- Квест приходит **в личные сообщения**, а если ЛС закрыты — бот отправит в группу уведомление с кнопкой.
- У квеста есть сюжет, задания, награда и риск (штрафы/блокировки операций).
- При провале: штраф, временная блокировка операций, возможные банковские последствия.
- При успехе: награда в валюте группы, лог в истории и рост активности.

### 11.2. Рекламные предложения (чёрный рынок)

В 21:00 по МСК бот отправляет случайному пользователю **витрину из 3 товаров**:

- Товары выбираются из фиксированного магазина.
- **Цены намного ниже**, чем в обычном магазине.
- **Активируемые товары** отображаются как «(2 шт)» и при покупке дают **2 покупки**.
- **Неактивируемые товары** имеют усиленный эффект (например «Прокачка рейтинга I (+5)»).
- Покупка имеет **шанс успеха 50%**: при неудаче деньги списываются, рейтинг падает.

Если пользователь **не реагирует 10 минут**, сообщение автоматически меняется на **«Слишком поздно»**.
После покупки исходное сообщение меняется на **«Вот и отлично»**.
Сообщения об удаче/неудаче отправляются отдельным сообщением.

---

## 11.3. Как купить товар чёрного рынка

- Покупка идёт **с баланса пользователя** и **в валюте группы**, которая прислала сообщение.
- Система покупки аналогична магазину: подтверждение → списание → выдача товара.
- Купить можно **только один товар** за сессию (после покупки остальные недоступны).
- Если покупка успешна — товар сразу попадает в историю покупок.
- Если покупка неудачна — товар не выдаётся, деньги списываются, рейтинг падает.

---

## 12. Роли, права, совладельцы и настройки

**Права ролей** задают доступ к функциям:

- просмотр баланса,
- банк,
- казино,
- рынок,
- работа,
- тёмный рынок,
- админские команды.

### 12.1. Роли и права

**Настройка ролей:**

- `/settings` → **Роли доступа** → нужная роль.
- В карточке роли доступна кнопка **«Загрузить доп. параметры»**.

### 12.2. Совладельцы группы

Совладельцы — это пользователи, которым владелец группы делегирует доступ к настройкам.

**Как добавить совладельца:**

1. Владелец открывает `/settings` → **Со-владельцы**.
2. Вводит `@username` участника.
3. Бот добавляет совладельца и даёт ему доступ к настройкам группы.

**Права совладельца:**

- Можно настраивать валюту и параметры группы.
- Можно заходить в `/settings` и видеть свою группу в списке.
- Доступ ограничивается отдельными правами (в настройках совладельца).
- Совладельцы **не видят** кнопку «Со-владельцы» — управлять другими может только владелец или создатель.

**Передача группы:**

- Владелец может передать группу совладельцу.
- После передачи права предыдущего владельца прекращаются (кроме создателя).

---

## 12.3. Реферальная система

Реферальная система позволяет приглашать новых пользователей и получать награды.

### Как получить реферальную ссылку

Бот выдаёт персональную ссылку вида:

```
https://t.me/<bot>?start=ref-<код>
```

Эту ссылку можно отправлять другим пользователям.

### Как засчитывается реферал

Реферал засчитывается, если:

- пользователь зашёл в бота впервые;
- он не является самим владельцем ссылки;
- ссылка ещё не использована этим пользователем ранее.

### Что получает приглашённый

После перехода по ссылке пользователь:

- регистрируется в базе бота;
- получает стандартный доступ к функциям (в зависимости от плана группы);
- отображается в списке рефералов пригласившего.

### Что получает пригласивший

Пригласивший пользователь получает:

- запись о реферале;
- уведомление в личных сообщениях;
- возможные бонусы (если включены в настройках бота).

### Важные ограничения

- Реферал засчитывается **только один раз**.
- Система защищена от повторных переходов.
- Самореферал запрещён.

---

## 13. Дополнительные параметры роли (settings.json)

### Как загрузить

1. Откройте `/settings` → **Роли доступа** → выберите роль.
2. Нажмите **«Загрузить доп. параметры»**.
3. Ответьте на сообщение бота файлом **`settings.json`**.

### Формат файла

`settings.json` - это **JSON-объект** с ключами параметров и значениями.

Пример:

```json
{
  "casino_lucky_chance_bonus_pct": 5,
  "bank_deposit_fee_discount_pct": 20,
  "market_trade_access": true,
  "jobs_salary_multiplier": 1.2
}
```

### Что делает система параметров

- Параметры **применяются только к одной роли**.
- Параметры можно задавать частично (остальные остаются стандартными).
- Неизвестные параметры игнорируются и выводятся предупреждением.

---

## 14. Список параметров роли (≈100 параметров)

> Ниже перечислены **все доступные параметры**, которые можно прописывать в `settings.json`.

| № | Ключ | Тип | Описание |
| --- | --- | --- | --- |
| 1 | `casino_lucky_chance_bonus_pct` | percent | Бонус к шансу выиграть в казино (в процентах). |
| 2 | `casino_house_edge_override_pct` | percent | Смещение базового преимущества казино. |
| 3 | `casino_max_bet_multiplier` | multiplier | Множитель максимальной ставки в казино. |
| 4 | `casino_min_bet_multiplier` | multiplier | Множитель минимальной ставки в казино. |
| 5 | `casino_payout_multiplier` | multiplier | Множитель выплат по выигрышам. |
| 6 | `casino_loss_protection_pct` | percent | Возврат части проигрыша (в %). |
| 7 | `casino_daily_limit_multiplier` | multiplier | Множитель дневного лимита ставок в казино. |
| 8 | `casino_win_streak_bonus_pct` | percent | Бонус к выигрышу при серии побед. |
| 9 | `casino_loss_streak_breaker_pct` | percent | Шанс прервать серию поражений. |
| 10 | `casino_game_cooldown_seconds` | seconds | Дополнительный кулдаун между играми казино. |
| 11 | `bank_deposit_fee_discount_pct` | percent | Скидка на комиссию депозита в банке. |
| 12 | `bank_withdraw_fee_discount_pct` | percent | Скидка на комиссию вывода средств. |
| 13 | `bank_transfer_fee_discount_pct` | percent | Скидка на комиссию банковских переводов. |
| 14 | `bank_credit_rate_discount_pct` | percent | Снижение процентной ставки по кредитам. |
| 15 | `bank_credit_limit_multiplier` | multiplier | Множитель максимального лимита кредита. |
| 16 | `bank_deposit_rate_bonus_pct` | percent | Дополнительная ставка по депозитам. |
| 17 | `bank_maintenance_fee_discount_pct` | percent | Снижение комиссии обслуживания счёта. |
| 18 | `bank_operation_limit_multiplier` | multiplier | Множитель лимитов операций банка. |
| 19 | `bank_transfer_delay_seconds` | seconds | Дополнительная задержка крупных переводов. |
| 20 | `bank_rating_gain_multiplier` | multiplier | Множитель роста банковского рейтинга. |
| 21 | `bank_rating_loss_multiplier` | multiplier | Множитель снижения банковского рейтинга. |
| 22 | `market_trade_fee_discount_pct` | percent | Скидка на торговую комиссию рынка. |
| 23 | `market_spread_discount_pct` | percent | Снижение спреда при торговле акциями. |
| 24 | `market_daily_trade_limit_multiplier` | multiplier | Множитель дневного лимита сделок. |
| 25 | `market_price_impact_multiplier` | multiplier | Множитель влияния сделки на цену. |
| 26 | `market_graph_days_bonus` | int | Дополнительные дни истории графика. |
| 27 | `market_news_priority_bonus` | int | Повышение приоритета рыночных новостей. |
| 28 | `market_arbitrage_access` | bool | Разрешение участвовать в арбитраже. |
| 29 | `market_order_access` | bool | Разрешение ставить ордера. |
| 30 | `market_volatility_safety_pct` | percent | Защита от волатильности (снижение просадки). |
| 31 | `market_listing_fee_discount_pct` | percent | Скидка на залог при создании доли. |
| 32 | `jobs_salary_multiplier` | multiplier | Множитель зарплаты за работу. |
| 33 | `jobs_success_bonus_pct` | percent | Бонус к шансу успешной работы. |
| 34 | `jobs_cooldown_seconds` | seconds | Дополнительный кулдаун для команд работы. |
| 35 | `jobs_quit_penalty_multiplier` | multiplier | Множитель штрафов за увольнение. |
| 36 | `jobs_rating_gain_multiplier` | multiplier | Множитель роста рейтинга работ. |
| 37 | `jobs_rating_loss_multiplier` | multiplier | Множитель потери рейтинга работ. |
| 38 | `jobs_double_pay_chance_pct` | percent | Шанс получить двойную оплату за работу. |
| 39 | `jobs_injury_protection_pct` | percent | Снижение шанса травмы/штрафа на работе. |
| 40 | `jobs_unlocks_premium` | bool | Разрешение на премиальные вакансии. |
| 41 | `shop_price_discount_pct` | percent | Скидка на покупки в магазине. |
| 42 | `shop_sell_bonus_pct` | percent | Бонус к доходу от продаж. |
| 43 | `shop_listing_limit_bonus` | int | Дополнительное количество выставляемых товаров. |
| 44 | `shop_tax_discount_pct` | percent | Снижение налога на продажи. |
| 45 | `shop_flash_sale_access` | bool | Доступ к флеш-распродажам. |
| 46 | `shop_purchase_limit_multiplier` | multiplier | Множитель лимитов покупок. |
| 47 | `shop_stock_bonus_pct` | percent | Вероятность получить бонусный товар. |
| 48 | `shop_refund_window_minutes` | int | Время для возврата покупки. |
| 49 | `dark_market_reward_multiplier` | multiplier | Множитель награды темного рынка. |
| 50 | `dark_market_penalty_discount_pct` | percent | Снижение штрафов темного рынка. |
| 51 | `dark_market_quest_chance_bonus_pct` | percent | Повышение шанса получить квест. |
| 52 | `dark_market_hint_quality_bonus` | int | Уровень улучшения подсказок. |
| 53 | `dark_market_cooldown_seconds` | seconds | Дополнительный кулдаун темного рынка. |
| 54 | `dark_market_failure_immunity_pct` | percent | Шанс избежать штрафа при провале. |
| 55 | `dark_market_double_reward_chance_pct` | percent | Шанс получить двойную награду. |
| 56 | `daily_reward_multiplier` | multiplier | Множитель ежедневной награды. |
| 57 | `daily_reward_bonus_pct` | percent | Дополнительный процент к дневной награде. |
| 58 | `daily_reward_streak_bonus` | int | Бонус за серию дней. |
| 59 | `activity_decay_multiplier` | multiplier | Множитель затухания активности. |
| 60 | `random_event_chance_bonus_pct` | percent | Бонус к шансу случайных событий. |
| 61 | `random_event_reward_multiplier` | multiplier | Множитель наград случайных событий. |
| 62 | `transfer_daily_limit_multiplier` | multiplier | Множитель дневного лимита переводов. |
| 63 | `transfer_fee_discount_pct` | percent | Скидка на комиссию переводов. |
| 64 | `transfer_min_amount` | int | Минимальная сумма перевода. |
| 65 | `transfer_max_amount` | int | Максимальная сумма перевода. |
| 66 | `anti_farm_delay_seconds` | seconds | Задержка для крупных переводов (анти-фарм). |
| 67 | `anti_farm_fee_pct` | percent | Доп. комиссия для крупных переводов. |
| 68 | `profile_visibility` | bool | Показывать расширенный профиль пользователя. |
| 69 | `top_visibility` | bool | Доступ к таблицам лидеров. |
| 70 | `profile_graph_access` | bool | Доступ к графику активности в профиле. |
| 71 | `profile_private_notes` | bool | Показывать приватные заметки (если используются скрипты). |
| 72 | `robbery_success_bonus_pct` | percent | Бонус к шансу успешного ограбления. |
| 73 | `robbery_penalty_discount_pct` | percent | Снижение штрафа при провале ограбления. |
| 74 | `robbery_cooldown_seconds` | seconds | Дополнительный кулдаун ограблений. |
| 75 | `robbery_bank_cap_multiplier` | multiplier | Множитель максимальной добычи ограбления банка. |
| 76 | `bankruptcy_cooldown_discount_pct` | percent | Снижение времени блокировки после банкротства. |
| 77 | `bankruptcy_penalty_discount_pct` | percent | Снижение штрафа за банкротство. |
| 78 | `credit_grace_period_days` | int | Дополнительный льготный период по кредитам. |
| 79 | `credit_payment_reminder_days` | int | Количество дней, за которое приходит напоминание о платеже. |
| 80 | `credit_overdue_penalty_discount_pct` | percent | Снижение штрафов за просрочку кредита. |
| 81 | `credit_auto_pay_access` | bool | Разрешение на автоплатеж кредита. |
| 82 | `treasury_access` | bool | Доступ к казне группы. |
| 83 | `treasury_bonus_multiplier` | multiplier | Множитель бонусов из казны. |
| 84 | `treasury_withdraw_limit` | int | Лимит на снятие из казны. |
| 85 | `bonus_event_visibility` | bool | Показывать уведомления о бонусных событиях. |
| 86 | `market_news_visibility` | bool | Показывать новости рынка. |
| 87 | `bank_notifications` | bool | Показывать уведомления банка. |
| 88 | `casino_notifications` | bool | Показывать уведомления казино. |
| 89 | `shop_notifications` | bool | Показывать уведомления магазина. |
| 90 | `dark_market_notifications` | bool | Показывать уведомления тёмного рынка. |
| 91 | `dm_only_notifications` | bool | Отправлять уведомления только в личку. |
| 92 | `command_cooldown_multiplier` | multiplier | Множитель глобальных кулдаунов команд. |
| 93 | `command_fail_refund_pct` | percent | Процент возврата при неудачной операции. |
| 94 | `inventory_slots_bonus` | int | Дополнительные слоты инвентаря. |
| 95 | `storage_fee_discount_pct` | percent | Скидка на хранение предметов. |
| 96 | `limit_free_mode_access` | bool | Доступ к режиму без лимитов (если включён). |
| 97 | `market_preview_access` | bool | Разрешение на предпросмотр рынков. |
| 98 | `market_trade_access` | bool | Разрешение на торговлю на рынке. |
| 99 | `market_alerts_access` | bool | Доступ к настройке рыночных алертов. |
| 100 | `market_insights_access` | bool | Доступ к расширенной аналитике рынка. |

## 15. Безопасность и анти-фарм

- Переводы имеют лимиты и комиссию.
- На крупные суммы действует задержка.
- Банк не даёт пассивного дохода.
- Мультиаккаунты отслеживаются через лимиты и санкции.

---

## 16. Частые вопросы

**Q: Почему я вижу рынок, но не могу торговать?**

A: Это предпросмотр для пользователей без подписки. Торговля, арбитраж и ордера доступны по планам выше BASIC.

**Q: Можно ли выдать разным ролям разные вероятности в казино?**

A: Да. Используйте параметр `casino_lucky_chance_bonus_pct` в `settings.json` конкретной роли.

**Q: Что делать, если параметры не загрузились?**

A: Проверьте, что файл называется **settings.json** и содержит корректный JSON-объект.
